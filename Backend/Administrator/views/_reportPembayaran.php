<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<div class="pagetitle">
    <h1>Rekepitulasi Persentase Penilaian Aspek Perilaku dan Prestasi Kerja (Lampiran V)</h1>
</div>

<!-- End Page Title -->
<section class="section">
    <div class="row">
        <div class="col-lg-12 ">
            <div class="card">
                <div class="card-body">
                    <div class="mt-3">
                        <form>
                            <div class="d-flex align-items-center mb-3">
                                <h5 style="margin-right: 10px; margin-bottom: 0;">Unit Kerja</h5>
                                <select class="form-select" style="width: 200px; margin-bottom: 0;">
                                <option selected disabled>Pilih Unit Kerja</option>
                                <option value="1">(1) DINAS KESEHATAN</option>
                                <option value="2">(2) RSU BANGUN PURBA</option>
                                <option value="3">(3) RSU PANCUR BATU</option>
                                <option value="4">(4) RSUD H. AMRI TAMBUNAN</option>
                                <option value="5">(5) UPT. PUSKESMAS ARAS KABU</option>
                                <option value="6">(6) UPT. PUSKESMAS BANDAR KHALIPAH KECAMATAN PERCUT SEI TUAN</option>
                                <option value="7">(7) UPT. PUSKESMAS BANDAR BARU KABUPATEN DELI SERDANG</option>
                                <option value="8">(8) UPT. PUSKESMAS BANGUN PURBA KABUPATEN DELI SERDANG</option>
                                <option value="9">(9) UPT. PUSKESMAS BATANG KUIS KEC. BATANG KUIS</option>
                                <option value="10">(10) UPT. PUSKESMAS BIRU - BIRU KECAMATAN BIRU -BIRU</option>
                                <option value="11">(11) UPT. PUSKESMAS DALU SEPULUH KEC. TANJUNG MORAWA</option>
                                <option value="12">(12) UPT. PUSKESMAS DELI TUA KECAMATAN DELI TUA</option>
                                <option value="13">(13) UPT. PUSKESMAS GALANG KEC. GALANG</option>
                                <option value="14">(14) UPT. PUSKESMAS GUNUNG MERIAH KEC. GUNUNG MERIAH</option>
                                <option value="15">(15) UPT. PUSKESMAS GUNUNG TINGGI KABUPATEN DELI SERDANG</option>
                                <option value="16">(16) UPT. PUSKESMAS HAMPARAN PERAK KEC. HAMPARAN PERAK</option>
                                <option value="17">(17) UPT. PUSKESMAS KARANG ANYAR</option>
                                <option value="18">(18) UPT. PUSKESMAS KENANGAN KECAMATAN PERCUT SEI TUAN</option>
                                <option value="19">(19) UPT. PUSKESMAS KOTA DATAR KECAMATAN HAMPARAN PERAK</option>
                                <option value="20">(20) UPT. PUSKESMAS KUTALIMBARU</option>
                                <option value="21">(21) UPT. PUSKESMAS LABUHAN DELI KECAMATAN LABUHAN</option>
                                <option value="22">(22) UPT. PUSKESMAS LUBUK PAKAM KEC. LUBUK PAKAM</option>
                                <option value="23">(23) UPT. PUSKESMAS MULYOREJO KEC. SUNGGAL</option>
                                <option value="24">(24) UPT. PUSKESMAS NAMORAMBE KABUPATEN DELI SERDANG</option>
                                <option value="25">(25) UPT. PUSKESMAS PAGAR JATI KEC. LUBUK PAKAM</option>
                                <option value="26">(26) UPT. PUSKESMAS PAGAR MERBAU KEC. PAGAR MERBAU</option>
                                <option value="27">(27) UPT. PUSKESMAS PANCUR BATU KABUPATEN DELI SERDANG</option>
                                <option value="28">(28) UPT. PUSKESMAS PANTAI LABU KEC. PANTAI LABU</option>
                                <option value="29">(29) UPT. PUSKESMAS PATUMBAK KECAMATAN PATUMBAK</option>
                                <option value="30">(30) UPT. PUSKESMAS PEMATANG JOHAR KEC. LABUHAN DELI</option>
                                <option value="31">(31) UPT. PUSKESMAS PETUMBUKAN KECAMATAN GALANG</option>
                                <option value="32">(32) UPT. PUSKESMAS SEI SEMAYANG KECAMATAN SUNGGAL</option>
                                <option value="33">(33) UPT. PUSKESMAS SEI MENCIRIM KABUPATEN DELI SERDANG</option>
                                <option value="34">(34) UPT. PUSKESMAS SIALANG</option>
                                <option value="35">(35) UPT. PUSKESMAS SIBOLANGIT KEC. SIBOLANGIT</option>
                                <option value="36">(36) UPT. PUSKESMAS TALUN KENAS KABUPATEN DELI SERDANG</option>
                                    <!-- Opsi Unit Kerja -->
                                </select>
                            </div>
                            <div class="d-flex align-items-center mb-3">
                                <h5 style="margin-right: 40px; margin-bottom: 0;">Bulan</h5>
                                <select class="form-select" style="width: 200px; margin-bottom: 0;">
                                <option selected disabled>Pilih Bulan</option>
                                <option value="1">(1) Januari</option>
                                <option value="2">(2) Februari</option>
                                <option value="3">(3) Maret</option>
                                <option value="4">(4) April</option>
                                <option value="5">(5) Mei</option>
                                <option value="6">(6) Juni</option>
                                <option value="7">(7) Juli</option>
                                <option value="8">(8) Agustus</option>
                                <option value="9">(9) September</option>
                                <option value="10">(10) Oktober</option>
                                <option value="11">(11) November</option>
                                <option value="12">(12) Desember</option>
                                <option value="13">(13) TPP THR</option>
                                <option value="14">(14) TPP 13</option>
                                    <!-- Opsi Bulan -->
                                </select>
                            </div>
                            <div class="d-flex align-items-center mb-3">
                                <h5 style="margin-right: 40px; margin-bottom: 0;">Tahun</h5>
                                <select class="form-select" style="width: 200px; margin-bottom: 0;">
                                    <option selected disabled>Pilih Tahun</option>
                                    <option value="1">2023</option>
                                    <option value="2">2022</option>
                                    <option value="3">2020</option>
                                        <!-- Opsi Tahun -->
                                </select>
                            </div>
                            <div class="d-flex align-items-center mb-3">
                                <button type="submit" name="submit" value="Submit" class="btn btn-primary btn-md">Submit</button>
                            </div>
                        </form>
                    </div>

                    <!-- End Large Modal-->
                    <!-- Table with stripped rows -->
                    <div class="table-responsive">
                        <div class="btn-group float-right">
                            <button type="button" onclick="exportToExcel('myTable')" class="btn btn-primary btn-md">Export to Excel</button>
                            <a href="../Administrator/dashboard_blank.php?page=Print_all" target="_blank" class="btn btn-success btn-md" style="margin-left: 10px;">Export PDF</a>
                        </div>
                        <table id="myTable" class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <!-- Column headers -->
                                    <th scope="col" rowspan="2" style="text-align: center;">No</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Nama/NIP</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Gol</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Jabatan/NPWP</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Kelas Jabatan</th> 
                                    <th scope="col" colspan="6" style="text-align: center;">Jumlah TPP</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Jumlah TPP Kotor</th> 
                                    <th scope="col" colspan="2" style="text-align: center;">Potongan</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Jumlah Potongan</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Jumlah Bersih</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">PPH Pasal 21</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Jumlah TPP yang Diterima</th> 
                                    <th scope="col" rowspan="2" style="text-align: center;">Tanda Tangan</th> 
                                </tr>
                            
                                <tr>
                                    <!-- sub Kompenen perhitungan -->
                                    <th scope="col" style="text-align: center;">Besaran TPP(Rp)</th>
                                    <th scope="col" style="text-align: center;">Total Persentase Penilaian (%)</th>
                                    <th scope="col" style="text-align: center;">Jumlah TPP</th>
                                    <th scope="col" style="text-align: center;">Pot. Bulan Lalu</th>
                                    <th scope="col" style="text-align: center;">Pot Hukuman Disiplin</th>
                                    <th scope="col" style="text-align: center;">Subsidi Pemkab BPJS 4%</th>
                                    <th scope="col" style="text-align: center;">Subsidi BPJS 4%</th>
                                    <th scope="col" style="text-align: center;">Pot Kewajiban BPJS 1%</th>
                                </tr>
                                <tr>
                                    <!-- Column headers -->
                                    <th scope="col"style="text-align: center;">1</th> 
                                    <th scope="col"style="text-align: center;">2</th> 
                                    <th scope="col"style="text-align: center;">3</th> 
                                    <th scope="col"style="text-align: center;">4</th> 
                                    <th scope="col"style="text-align: center;">5</th> 
                                    <th scope="col"style="text-align: center;">6</th> 
                                    <th scope="col"style="text-align: center;">7</th> 
                                    <th scope="col"style="text-align: center;">8</th> 
                                    <th scope="col"style="text-align: center;">9</th> 
                                    <th scope="col"style="text-align: center;">10</th> 
                                    <th scope="col"style="text-align: center;">11</th> 
                                    <th scope="col"style="text-align: center;">12=(8+11)-(9+10)</th> 
                                    <th scope="col"style="text-align: center;">13</th> 
                                    <th scope="col"style="text-align: center;">14</th> 
                                    <th scope="col"style="text-align: center;">15=(13+14)</th> 
                                    <th scope="col"style="text-align: center;">16=(12-15)</th> 
                                    <th scope="col"style="text-align: center;">17</th> 
                                    <th scope="col"style="text-align: center;">18=(16-17)</th> 
                                    <th scope="col"style="text-align: center;">19</th> 
                                </tr>
                            </thead>
                            <tbody>
                                    <td>1</td>
                                    <td>Oman/2123132123</td>
                                    <td>IV/e</td>
                                    <td>IT SIMRS/5456417</td>
                                    <td>00.00</td>
                                    <td>60.00</td>
                                    <td>20.00</td>
                                    <td>20.00</td>
                                    <td>00.00</td>
                                    <td>00.00</td>
                                    <td>100%</td>
                                    <td>20.00</td>
                                    <td>00.00</td>
                                    <td>00.00</td>
                                    <td>100%</td>
                                    <td>00.00</td>
                                    <td>60.00</td>
                                    <td>20.00</td>
                                    <td>20.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<script>
    function exportToExcel(tableId) {
        // Ambil elemen tabel berdasarkan ID
        var table = document.getElementById(tableId);
        var rows = table.querySelectorAll('tr');
      
        // Buat objek Excel dengan format yang sesuai
        var excel = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">';
        excel += '<head><meta charset="UTF-8"></head><body>';

        excel += '<style>';
        excel += 'h5 { margin: 0; padding: 0; font-weight: normal;}'; // Mengatur margin dan padding menjadi 0 untuk tag h5
        excel += 'table { border-collapse: collapse; width: 100%; }'; // Menambahkan aturan CSS untuk tabel
        excel += 'td, th { border: 1px solid black; padding: 5px; }'; // Menambahkan aturan CSS untuk sel-sel tabel
        excel += '</style>';

        excel += '<h5>LAMPIRAN VI</h5>';
        excel += '<h5>PERATURAN BUPATI DELI SERDANG</h5>';
        excel += '<h5>NOMOR 04 TAHUN 2019</h5>';
        excel += '<h5>TENTANG</h5>';
        excel += '<h5>TAMBAHAN PENGHASILAN PEGAWAI NEGERI SIPIL DAERAH</h5>';
        excel += '<h5>KABUPATEN DELI SERDANG</h5>';
        // Tambahkan judul tabel dan bulan
        excel += '<h3 style="text-align: center;">REKAPITULASI PERSENTASE PENILAIAN ASPEK PERILAKU KERJA DAN ASPEK PRESTASI KERJA PNSD<br>';
        excel += 'DINAS KESEHATAN KABUPATEN DELI SERDANG<br>';
        excel += 'DINAS KESEHATAN</h3>';

        excel += '<h5><b>BULAN: JANUARI 2023</b></h5>';

        excel += '<table>';
        for (var i = 0; i < rows.length; i++) {
            excel += rows[i].outerHTML;
        }
        excel += '</table>';


        excel += '<table style="border-collapse: collapse; font-family: Arial Narrow; font-size: 8pt; width: 100%;">';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-
        excel += '<td colspan="3" style="border: none;">TELAH DIVERIFIKASI OLEH</td>'; // Kolom 4-12, Baris 1
        excel += '<td colspan="4" style="border: none;"></td>'; // Kolom 4-12, Baris 1
        excel += '<td colspan="3" style="border: none;">Lubuk Pakam,</td>'; // Kolom 4-12, Baris 1
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="3" style="border: none;">Tanggal</td>'; // Kolom 4-12, Baris 2
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="3" style="border: none;">Ka. Sub. Bag. Hukum, Kepegawaian dan Umum</td>'; // Kolom 4-12, Baris 5
        excel += '<td colspan="4" style="border: none;"></td>'; // Kolom 4-12, Baris 1
        excel += '<td colspan="3" style="border: none;">Sekretaris Dinas Kesehatan</td>'; // Kolom 4-12, Baris 1
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="3" style="border: none;">Dinas Kesehatan Kabupaten Deli Serdang</td>'; // Kolom 4-12, Baris 6
        excel += '<td colspan="4" style="border: none;"></td>'; // Kolom 4-12, Baris 1
        excel += '<td colspan="3" style="border: none;">Dinas Kesehatan Kabupaten Deli Serdang</td>'; // Kolom 4-12, Baris 1
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="3" style="border: none;"><u>Sri Rezeki</u></td>'; // Kolom 4-12, Baris 10
        excel += '<td colspan="4" style="border: none;"></td>'; // Kolom 4-12, Baris 1
        excel += '<td colspan="3" style="border: none;"><u>dr. Tetty Rossanti Keliath</u></td>'; // Kolom 4-12, Baris 1
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="3" style="border: none;">NIP. 19710712 199303 1009</td>'; // Kolom 4-12, Baris 11
        excel += '<td colspan="4" style="border: none;"></td>'; // Kolom 4-12, Baris 1
        excel += '<td colspan="3" style="border: none;">NIP. 19770418 200312 2 009</td>'; // Kolom 4-12, Baris 1
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="3" style="border: none;">Pejabat di Bidang Pemberhentian dan Pensiun BKD</td>'; // Kolom 4-12, Baris 14
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="12" style="border: none;">NIP.</td>'; // Kolom 1-12, Baris 18
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="3" style="border: none;">Pejabat di Bidang Penilaian Kinerja Aparatur dan Promosi BKD</td>'; // Kolom 4-12, Baris 19
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="12" style="border: none;"></td>'; // Kolom 1, Baris 1-19 kosong
        excel += '</tr>';
        excel += '<tr>';
        excel += '<td colspan="1" style="border: none;"></td>'; // Kolom 1-3, Baris 1-19 kosong
        excel += '<td colspan="12" style="border: none;">NIP.</td>'; // Kolom 1-12, Baris 23
        excel += '</tr>';
        excel += '</table>';

        
        // Tutup tag HTML
        excel += '</body></html>';

        // Buat blob dari objek Excel
        var blob = new Blob([excel], { type: 'application/vnd.ms-excel' });
        
        // Buat URL dari blob
        var url = URL.createObjectURL(blob);
        
        // Buat link untuk download file Excel
        var a = document.createElement('a');
        a.href = url;
        a.download = 'exported_data.xls'; // Nama file Excel yang akan diunduh
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }
    function exportToPdf() {
    console.log('Fungsi exportToPdf() dipanggil.');
    var doc = new jsPDF();
    doc.text('Ini adalah konten PDF yang dibuat secara dinamis.', 10, 10);
    doc.save('nama_file.pdf');
}

</script>
<!-- <script>

</script> -->
